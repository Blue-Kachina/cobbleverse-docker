services:
  mc:
    image: itzg/minecraft-server:latest
    container_name: cobbleverse-server
    restart: unless-stopped
    ports:
      - "25565:25565"
    volumes:
      - ./data:/data
      - ./backups:/backups
    env_file:
      - .env
    environment:
      # Required to run the server
      EULA: "TRUE"
      # Cobbleverse 1.6 uses Fabric
      TYPE: "FABRIC"
      # Helpful JVM tuning flags from Aikar
      USE_AIKAR_FLAGS: "true"
      # Memory recommendation for Cobblemon-heavy packs; can be overridden in .env
      MEMORY: "${MEMORY:-6G}"
      # Phase 2: Modrinth modpack installer settings
      # Set MODRINTH_URL in your .env to enable automatic modpack install
      USE_MODPACK_CACHE: "true"
      REMOVE_OLD_MODS: "true"
      OVERRIDE_SERVER_PROPERTIES: "true"
    # Uncomment if you want simple health insight later (Phase 7+)
    # healthcheck:
    #   test: ["CMD", "/usr/lib/mc-monitor", "status", "--host", "localhost", "--port", "25565"]
    #   interval: 30s
    #   timeout: 10s
    #   retries: 5

# Networks/extra settings can be added in later phases as needed
